/*
	Name: jQuery lastTweet
	Description: A simple jquery script (in its earliest stages) that retrieves a users latest tweet(s)
	Version: 0.1
	Author: Maximilian Zimmer (@designlovr)
	Author Url: http://designlovr.tumblr.com
	Plugin Url: https://github.com/ximi/lastTweet
	License: MIT (http://mit-license.org/)
	Credits:
		-jQuery Plugin Boilerplate by Stefan Gabos: http://stefangabos.ro/jquery/jquery-plugin-boilerplate-revisited/
		-twitterjs by Remy Sharp: http://code.google.com/p/twitterjs/source/browse/tags/1.13.1/src/twitter.js
*/

(function(a){a.lastTweet=function(b,c){var d={count:1,include_rts:true,exclude_replies:true,before_tweet:"<p>",after_tweet:"</p>",onInit:function(){f.append('<p class="loading">Loading...</p>')},onError:function(){f.append('<p class="error">An error occured while retrieving tweets</p>')},onSuccess:function(){},onComplete:function(){f.find(".loading").remove()}};var e=this;e.settings={};var f=a(b),b=b;var g=function(){e.settings=a.extend({},d,c);if(e.settings.hasOwnProperty("user_id")||e.settings.hasOwnProperty("screen_name")){e.settings.onInit();var b=h();a.ajax({dataType:"jsonp",url:b,success:function(a,b,c){var d=0,g,h="";for(d=0,g=a.length;d<g;d++){var i=e.atify(e.wrapLinks(a[d].text));h+=e.settings.before_tweet+i+e.settings.after_tweet}f.append(h);e.settings.onSuccess(a,b,c)},error:function(a,b,c){e.settings.onError(a,b,c)},complete:function(a,b){e.settings.onComplete(a,b)}})}else{a.error("No user id or screen name were provided")}};var h=function(){var a="http://api.twitter.com/1/statuses/user_timeline.json?",b;if(e.settings.hasOwnProperty("user_id")){b="user_id="+e.settings.user_id}else{b="screen_name="+e.settings.screen_name}var c=a+b+"&trim_user=true&count="+e.settings.count+"&include_rts="+e.settings.include_rts+"&exclude_replies="+e.settings.exclude_replies;return c};e.wrapLinks=function(a){return a.replace(/[a-z]+:\/\/[a-z0-9-_]+\.[a-z0-9-_:~%&\?\/.=]+[^:\.,\)\s*$]/ig,function(a){return'<a href="'+a+'">'+a+"</a>"})};e.atify=function(a){return a.replace(/(^|[^\w]+)\@([a-zA-Z0-9_]{1,15})/g,function(a,b,c){return b+'<a href="http://twitter.com/'+c+'">@'+c+"</a>"})};g()};a.fn.lastTweet=function(b){return this.each(function(){if(undefined==a(this).data("lastTweet")){var c=new a.lastTweet(this,b);a(this).data("lastTweet",c)}})}})(jQuery)